{% extends 'base.html' %}
{% load static %}

{% block title %}My Uploads - Edify{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/uploadsCss.css' %}">
{% endblock %}

{% block content %}
<div class="uploads-container">
  <!-- Header -->
  <div class="header">
    <div class="header-left">
      <h1>My Uploads</h1>
    </div>
     
    <!-- Add Files button -->
    <a href="{% url 'addfiles' %}" class="upload-btn">
      <i class="fa-solid fa-plus"></i> Add Files
    </a>
  </div>

  <!-- Attached Files Section -->
  <div class="attached-header">
    <div class="attached-left">
      <h2>Attached Files</h2>
      <p>Here you can explore your uploaded files</p>
    </div>

    <div class="attached-actions">
      <!-- Search -->
      <div class="search-container">
        <input type="text" id="searchInput" placeholder="Search files..." />
        <button class="circle-btn" id="searchBtn">
          <i class="fa-solid fa-magnifying-glass"></i>
        </button>
      </div>

      <!-- Filter -->
      <div class="filter-container">
        <select id="filterSelect">
          <option value="">All</option>
          <option value="Rizal">Rizal</option>
          <option value="Math">Math</option>
          <option value="Science">Science</option>
        </select>
        <button class="circle-btn" id="filterBtn">
          <i class="fa-solid fa-filter"></i>
        </button>
      </div>
    </div>
  </div>

  <!-- Files Table -->
  <div class="table-container" id="uploadsTable">
    <table>
      <thead>
        <tr>
          <th>File Name</th>
          <th>File Size</th>
          <th>File Type</th>
          <th>Subject</th>
          <th>Grade/Year Level</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody id="fileList">
          {% for file in resources %}
          <tr>
            <td>{{ file.title }}</td>
            <td>{{ file.file_size }}</td>
            <td>{{ file.file_type }}</td>
            <td>{{ file.subject }}</td>
            <td>{{ file.grade_level }}</td>
            <td>
              <a href="{{ file.file_path }}" target="_blank" class="btn-action view">View</a>
              <a href="{% url 'edit_file' file.id %}" class="btn-action edit">Edit</a>
              <form action="{% url 'delete_file' file.id %}" method="post" style="display:inline;">
                {% csrf_token %}
                <button type="submit" class="btn btn-danger btn-sm">Delete</button>
              </form>
            {% if file.is_favorite %}
                <a href="{% url 'toggle_favorite' file.id %}" style="color: gold;">★ Favorited</a>
            {% else %}
                <a href="{% url 'toggle_favorite' file.id %}">☆ Favorite</a>
            {% endif %}
          </td>
          </tr>
          {% empty %}
          <tr>
              <td colspan="6" style="text-align:center;">No uploads yet.</td>
          </tr>
        {% endfor %}
      </tbody>
    </table>

    <!-- Empty State -->
    <div id="emptyState" class="empty-state" style="display: none;">
      <h3>No files uploaded yet.</h3>
      <p>Upload a file to get started.</p>
    </div>
  </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="{% static 'js/uploads.js' %}"></script>
{% endblock %}
