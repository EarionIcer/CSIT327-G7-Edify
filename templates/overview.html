{% extends "base.html" %}
{% load static %}

{% block title %}Overview - Edify{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/overviewCss.css' %}">
{% endblock %}

{% block content %}

<div class="overview-container">

    <!-- Header -->
    <div class="page-header">
        <div>
            <h1 class="page-title">Overview</h1>
            <p class="page-subtitle">Welcome back! Here's what's happening with your files.</p>
        </div>
        <!-- Date/Time display or simple greeting could go here -->
    </div>

    <!-- STATS ROW -->
    <div class="stats-grid">
        <div class="stat-card">
            <div class="stat-icon bg-indigo">
                <i class="fa-solid fa-cloud-arrow-up"></i>
            </div>
            <div class="stat-info">
                <h2>{{ total_uploads|default:"0" }}</h2>
                <p>Total Uploads</p>
            </div>
        </div>

        <div class="stat-card">
            <div class="stat-icon bg-red">
                <i class="fa-solid fa-heart"></i>
            </div>
            <div class="stat-info">
                <h2>{{ favorites_count|default:"0" }}</h2>
                <p>Favorites</p>
            </div>
        </div>

        <div class="stat-card">
            <div class="stat-icon bg-green">
                <i class="fa-solid fa-book-open"></i>
            </div>
            <div class="stat-info">
                <h2>{{ subjects_count|default:"0" }}</h2>
                <p>Subjects</p>
            </div>
        </div>

        <div class="stat-card">
            <div class="stat-icon bg-orange">
                <i class="fa-solid fa-database"></i>
            </div>
            <div class="stat-info">
                <h2>{{ total_storage|default:"0GB" }}</h2>
                <p>Storage Used</p>
            </div>
        </div>
    </div>

    <!-- PUBLIC FILES SECTION -->
    <div class="card action-banner">
        <div class="action-content">
            <div class="action-text">
                <h3>Explore Public Resources</h3>
                <p>Access shared materials from the global educator community.</p>
            </div>
            <!-- Updated URL to match your views logic (search page) -->
            <a href="{% url 'public' %}" class="btn-public">
                <i class="fa-solid fa-globe"></i> Public Files
            </a>
        </div>
    </div>

    <!-- MAIN CONTENT GRID -->
    <div class="content-grid">
        
        <!-- Recent Uploads -->
        <div class="card recent-files">
            <div class="card-header">
                <h3><i class="fa-regular fa-clock"></i> Recent Uploads</h3>
                <a href="{% url 'uploads' %}" class="view-all">View All</a>
            </div>

            <div class="card-body">
                {% if recent_uploads %}
                    <ul class="file-list">
                        {% for file in recent_uploads %}
                            <li class="file-item">
                                <div class="file-icon-wrapper">
                                    <i class="fa-solid fa-file-lines"></i>
                                </div>
                                <div class="file-details">
                                    <span class="file-name">{{ file.title }}</span>
                                    <div class="file-meta">
                                        <span>{{ file.subject }}</span>
                                        <span class="dot">•</span>
                                        <span>{{ file.grade }}</span>
                                        <span class="dot">•</span>
                                        <span>{{ file.file_size }}</span>
                                    </div>
                                </div>
                                <span class="file-time">{{ file.time_ago }}</span>
                            </li>
                        {% endfor %}
                    </ul>
                {% else %}
                    <div class="empty-state">
                        <div class="empty-icon"><i class="fa-solid fa-folder-open"></i></div>
                        <p>No recent uploads found.</p>
                        <a href="{% url 'uploads' %}" class="btn-small">Upload Now</a>
                    </div>
                {% endif %}
            </div>
        </div>

        <!-- Favorite Files -->
        <div class="card favorite-files">
            <div class="card-header">
                <h3><i class="fa-solid fa-heart text-red-500"></i> Favorites</h3>
                <a href="{% url 'favorites' %}" class="view-all">View All</a>
            </div>

            <div class="card-body">
                {% if favorites %}
                    <ul class="file-list">
                        {% for file in favorites %}
                            <li class="file-item">
                                <a href="{{ file.file_path }}" target="_blank" class="file-link-wrapper">
                                    <div class="file-icon-wrapper fav">
                                        <i class="fa-solid fa-heart"></i>
                                    </div>
                                    <div class="file-details">
                                        <span class="file-name">{{ file.title }}</span>
                                        <div class="file-meta">
                                            <span>{{ file.subject|default:"General" }}</span>
                                            <span class="dot">•</span>
                                            <span>{{ file.file_size|default:"N/A" }}</span>
                                        </div>
                                    </div>
                                </a>
                            </li>
                        {% endfor %}
                    </ul>
                {% else %}
                    <div class="empty-state">
                        <div class="empty-icon"><i class="fa-regular fa-heart"></i></div>
                        <p>No favorites yet.</p>
                        <span class="text-sm text-gray">Heart files to see them here.</span>
                    </div>
                {% endif %}
            </div>
        </div>

    </div>

</div>

{% endblock %}